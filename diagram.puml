@startuml
!theme materia

' Oculta atributos e métodos para um diagrama mais limpo.
' Remova as duas linhas abaixo se quiser ver mais detalhes.
hide empty members
skinparam classAttributeIconSize 0

title Diagrama de Classes - Projeto Phantom

package "Controler" <<Frame>> {
    class Engine {
        + run()
        - atualizar()
    }
    class ControleDeJogo {
        - quadtree: Quadtree
        + processaTudo()
    }
    class GerenciadorDeFases
    class Tela extends JFrame
    class Cenario extends JPanel
}

package "Modelo" <<Code>> {
    abstract class Personagem {
        # x: double
        # y: double
        + {abstract} atualizar()
        + autoDesenho()
    }

    package "Fases" {
        class Fase {
            - personagens: List<Personagem>
        }
        abstract class ScriptDeFase {
            + {abstract} carregarRecursos()
            + {abstract} atualizarInimigos()
        }
        class ScriptFase1 extends ScriptDeFase
    }

    package "Entidades" {
        class Hero extends Personagem
        abstract class Inimigo extends Personagem
        class FadaComum1 extends Inimigo
        abstract class Boss extends Inimigo
        class Projetil extends Personagem
        class Item extends Personagem
    }
}

package "Auxiliar" <<Toolkit>> {
    class ProjetilPool
    class ItemPool
    class Quadtree
    class SoundManager << (S, #FF7700) Singleton >>
    class CarregadorDeDefinicoes << (S, #FF7700) Singleton >>
}

class Main

' --- Relacionamentos Principais ---

Main ..> Engine : cria e inicia

Engine *-- "1" Fase : gerencia
Engine *-- "1" ControleDeJogo : utiliza
Engine *-- "1" GerenciadorDeFases : utiliza
Engine ..> Cenario : atualiza

Tela *-- "1" Cenario : contém

Fase *-- "1" ScriptDeFase : é controlada por
Fase o-- "many" Personagem : contém
Fase *-- "1" ProjetilPool
Fase *-- "1" ItemPool

GerenciadorDeFases ..> ScriptFase1 : cria

ControleDeJogo ..> Quadtree : utiliza para colisões

' --- Relacionamentos de Herança ---
Hero --|> Personagem
Inimigo --|> Personagem
Projetil --|> Personagem
Item --|> Personagem
Boss --|> Inimigo
FadaComum1 --|> Inimigo

' --- Relacionamentos de Uso (Singletons e outros) ---
Projetil ..> CarregadorDeDefinicoes : usa para obter definições
Engine ..> SoundManager : usa para tocar sons

note right of Engine
  **Coração do Jogo**
  Contém o Game Loop principal
  e a máquina de estados
  (Jogando, GameOver, etc).
end note

note top of Personagem
  **Classe Base Abstrata**
  Define o comportamento
  comum de todas as
  entidades do jogo.
end note

note left of ScriptDeFase
  **Design de Nível**
  Cada script define os
  eventos e inimigos
  de uma fase específica,
  tornando o jogo extensível.
end note
@enduml